rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Bookings collection
    match /bookings/{bookingId} {
      // Allow read for everyone (needed for availability check and admin panel)
      allow read: if true;
      
      // Allow create for everyone (public booking form)
      allow create: if request.resource.data.keys().hasAll([
        'checkIn', 'checkOut', 'guests', 'firstName', 'lastName', 
        'email', 'phone', 'nights', 'totalPrice', 'pricePerNight', 
        'status', 'createdAt'
      ]) && request.resource.data.status == 'pending';
      
      // Allow update/delete for everyone (TODO: add auth for admin only)
      allow update, delete: if true;
    }
  }
}

